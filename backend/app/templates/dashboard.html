{% extends "layout.html" %}
{% block content %}
    <section class="dashboard">
        <h2>Welcome, {{ current_user.username }}!</h2>

        <div class="overview">
            <h3>Your Mood Overview</h3>
            <p>Here is a summary of your mental health assessment and mood over time:</p>
            <div id="mood-chart"></div>
        </div>

        <div class="recent-assessments">
            <h3>Recent Assessments</h3>
            <ul>
                {% for assessment in assessments %}
                    <li>
                        <strong>Date:</strong> {{ assessment.date }} | 
                        <strong>Prediction:</strong> {{ assessment.prediction }} 
                        <a href="{{ url_for('results', assessment_id=assessment.id) }}" class="btn btn-secondary">View Details</a>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="actions">
            <a href="{{ url_for('assessment') }}" class="btn btn-primary">Take a New Assessment</a>
            <a href="{{ url_for('profile') }}" class="btn btn-secondary">View Your Profile</a>
        </div>
    </section>

    <script src="{{ url_for('static', filename='js/plotly-latest.min.js') }}"></script>
    <script>
        // Plotly chart for mood overview
        var moodData = {{ mood_data | safe }};
        var layout = {
            title: 'Mood Over Time',
            xaxis: { title: 'Date' },
            yaxis: { title: 'Mood Level' }
        };
        Plotly.newPlot('mood-chart', moodData, layout);
    </script>
{% endblock %}
